% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lsd.R
\name{lsd}
\alias{lsd}
\title{Local Standardized Mean Difference (LSD) Calculation}
\usage{
lsd(
  object = NULL,
  Z = NULL,
  Tr = NULL,
  ps = NULL,
  ck = NULL,
  h = NULL,
  K = 99,
  rho = 0.15,
  kernel = "gaussian",
  ate_flag = 1,
  ...
)
}
\arguments{
\item{object}{An optional object of class `lbc_net`. If provided, extracts `Z`, `Tr`, `ps`, `ck`, `h`, and `kernel`.}

\item{Z}{A matrix or data frame of covariates. Required if `object` is not provided.}

\item{Tr}{A binary vector indicating treatment assignment (1 for treatment, 0 for control). Required if `object` is not provided.}

\item{ps}{A vector of propensity scores. Required if `object` is not provided.}

\item{ck}{A numeric vector of pre-specified grid points for local balance assessment. If NULL, it is automatically calculated.}

\item{h}{A numeric vector of bandwidths. If NULL, it is automatically calculated.}

\item{K}{The number of grid points to use if `ck` is not provided. Default is 99.}

\item{rho}{A scaling parameter used in bandwidth calculation. Default is 0.15.}

\item{kernel}{The kernel function used. Options are "gaussian", "uniform", or "epanechnikov". Default is "gaussian".}

\item{ate_flag}{An integer (0 or 1) specifying the target estimand. The default is 1, which estimates the
Average Treatment Effect (ATE) by weighting all observations equally. Setting it to 0 estimates the
Average Treatment Effect on the Treated (ATT), where only treated units are fully weighted while control
units are downweighted based on their propensity scores. See Details in \code{\link{lbc_net}}.}

\item{...}{Additional arguments passed to the specific method.}
}
\value{
An object `lsd` containing LSD values (\%) for each covariate, which includes:
  \itemize{
        \item `LSD`: A matrix of LSD values for each covariate at each `ck`.
        \item `LSD_mean`: The mean absolute LSD value across all covariates.
        \item `LSD_max`: The maximum absolute LSD value.
      }
Other model components (e.g., `Z`, `Tr`) are accessible via `$`
or the recommended \code{\link[=getLBC.lsd]{getLBC}} function. While direct access (e.g., `fit$fitted.values`)
is possible, using `getLBC(fit, "LSD")` is recommended for stability and future-proofing.
}
\description{
Computes the Local Standardized Mean Difference (LSD) for assessing local balance in causal inference.
The LSD measures the standardized mean difference for covariates at pre-specified grid points `ck` using kernel-based local inverse probability weighting of propensity scores.
}
\details{
See \code{\link{lbc_net}} for details for local kernel weights and arguments `ck`, `h`, `K`, `rho`, and `kernel`.

The formula for LSD follows the same structure as the Global Standardized Mean Difference (GSD) (\code{\link{gsd}}),
but the weights `W_i` are replaced with `W'_i`, Local Inverse Probability Weight (LIPW). LSD is expressed as a percentage in absolute value.

Like GSD, LSD can be used for assessing balance in covariates, but LSD is specific to propensity score-based methods.
}
\examples{
# Example with manually provided inputs
set.seed(123)
Z <- matrix(rnorm(200), nrow = 100, ncol = 2)
Tr <- rbinom(100, 1, 0.5)
ps <- runif(100, 0.1, 0.9)  # Simulated propensity scores

# Compute LSD using manually provided inputs
lsd_result <- lsd(Z = Z, Tr = Tr, ps = ps, K = 99)
print(lsd_result)
summary(lsd_result)

# Compute and visualize LSD results
plot(lsd_result)

\dontrun{
# Fit LBC-Net model
model <- lbc_net(data = data, formula = Tr ~ X1 + X2 + X3 + X4)

# Compute LSD from the fitted model for ATE.
lsd_fit <- lsd(model)
print(lsd_fit)
summary(lsd_result)

# Visualize LSD results
plot(lsd_fit)
}
}
