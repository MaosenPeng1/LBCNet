% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/span_bw.R
\name{span_bw}
\alias{span_bw}
\title{Compute Adaptive Bandwidth for Kernel Smoothing}
\usage{
span_bw(rho, ck, p)
}
\arguments{
\item{rho}{Numeric. The span (proportion of data points) used to determine the adaptive bandwidth.
Ensures a sufficient local sample size for accurate balance estimation.}

\item{ck}{Numeric vector. Pre-specified kernel center points, strictly between 0 and 1.}

\item{p}{Numeric vector. Estimated propensity scores, with values strictly between 0 and 1.
Typically generated from logistic regression but can be user-supplied.}
}
\value{
A numeric vector of bandwidth values (`h`), corresponding to each `ck`.
}
\description{
This function calculates adaptive bandwidth values (`h`) for kernel smoothing
based on a given span (`rho`) and estimated propensity scores (`p`).
It is used in \code{\link{lbc_net}} but can also be applied independently
for bandwidth selection in other kernel-based methods.
}
\details{
The adaptive bandwidths (`h`) ensure that each local region contains approximately
\code{rho * N} observations, where \code{N} is the total number of observations.
This helps maintain stable kernel-based local balance estimation.
}
\examples{
# Simulated dataset
set.seed(123)
N <- 500
Z <- as.data.frame(matrix(rnorm(N * 5), ncol = 5))
colnames(Z) <- paste0("X", 1:5)
T <- rbinom(N, 1, 0.5)  # Binary treatment assignment

# Logistic regression for propensity score estimation
log.fit <- glm(T ~ ., data = Z, family = "binomial")
p <- log.fit$fitted.values  # Extract estimated propensity scores

# Compute bandwidths
ck <- seq(0.01, 0.99, 0.01)  # Kernel center points
rho <- 0.15  # Span
h <- span_bw(rho, ck, p)
print(h)

}
